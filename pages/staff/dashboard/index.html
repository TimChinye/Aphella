<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Hello Express!</title>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width" />

		<base href='/staff/dashboard/'>

		<link rel="stylesheet" href="../../keyframes.css" />
		<link rel="stylesheet" href="../../global.css" />
		<link rel="stylesheet" href="./styles.css" />
  </head>   
  <body>
    <script type="text/javascript" src="../../main.js"></script>
    <aside>
        <div>
            <figure>
				        <a href="/"><img src="../../assets/Aphella Logo.png"></a>
                <hr>
                <ul>
                  <li class="active"><a href="/dashboard">Dashboard<img src="https://img.icons8.com/fluency-systems-regular/48/FF005D/dashboard-layout.png"/><img src="https://img.icons8.com/fluency-systems-filled/48/FFFFFF/dashboard-layout.png"/></a></li>
                  <li><a href="/chat">Chat<img src="https://img.icons8.com/fluency-systems-regular/48/FF005D/messaging-.png"/><img src="https://img.icons8.com/fluency-systems-filled/48/FFFFFF/messaging-.png"/></a></li>
                  <li><a href="/appointments">Appointments<img src="https://img.icons8.com/fluency-systems-regular/48/FF005D/thursday.png"/><img src="https://img.icons8.com/fluency-systems-filled/48/FFFFFF/thursday.png"/></a></li>
                  <li><a href="/payments">Payments<img src="https://img.icons8.com/fluency-systems-regular/48/FF005D/bank-card-front-side.png"/><img src="https://img.icons8.com/fluency-systems-filled/48/FFFFFF/bank-card-front-side.png"/></a></li>
                  <li><a href="/settings">Settings<img src="https://img.icons8.com/fluency-systems-regular/48/FF005D/settings--v1.png"/><img src="https://img.icons8.com/fluency-systems-filled/48/FFFFFF/settings--v1.png"/></a></li>
                  <li><a href="/logout">Log Out<img src="https://img.icons8.com/fluency-systems-regular/48/FF005D/exit--v1.png"/><img src="https://img.icons8.com/fluency-systems-filled/48/FFFFFF/exit--v1.png"/></a></li>
                </ul>
			</figure>
        </div>
        <footer>
            <p>Designed & Developed by <a href="https://timchinye.com/">Tim Chinye</a>.<br>Icons by <a href="https://icons8.com/">Icons8</a></p>
        </footer>
    </aside>
    <main>
      <figure id="loadingOverlay" onanimationstart="updateLoadingStatus(event)" onanimationiteration="updateLoadingStatus(event)">
        <div>
          <div class="dot union"></div>
          <div class="dot"></div>
          <div class="dot"></div>
          <div class="dot"></div>
          <div class="dot"></div>
        </div>
      </figure>

      <section>
        <div id="wrapper">
          <nav>
              <search>
                  <input type="search" placeholder="Search..." />
              </search>
              <div id="account">
                  <img src="https://img.icons8.com/fluency-systems-filled/48/CCCCCC/appointment-reminders.png"/>
                  <span></span>
                  <div><img id="profile-pic" src="https://wallpapers.com/images/hd/generic-male-avatar-profile-2fudx37oj7ug3d8l.jpg"></div>
                  <div>
                      <h4 id="name">John Doe</h4>
                      <h6 id="role">Stakeholder</h6>
                  </div>
              </div>
          </nav>
          <header>
              <h1>Dashboard</h1>
              <div style="display: flex; gap: 1rem;">
                  <button>Make an Appointment</button>
                  <button>Make a Request</button>
              </div>
          </header>
          <div id="layout-grid">
              <article id="patients-today">
                  <img src="https://img.icons8.com/fluency-systems-filled/48/C40148/guest-male.png" style="filter: brightness(0.95);"/>
                  <div>
                      <h5>Patients Today</h5>
                      <h3>#</h3>
                  </div>
              </article>
              <article id="regular-patients-total">
                  <img src="https://img.icons8.com/fluency-systems-filled/48/C40148/conference-call.png" style="filter: brightness(1.05);"/>
                  <div>
                      <h5>Total Regular Patients</h5>
                      <h3>#</h3>
                  </div>
              </article>
              <article id="incomplete-requests">
                  <img src="https://img.icons8.com/fluency-systems-filled/48/C40148/ask-question.png" style="filter: brightness(1.00);"/>
                  <div>
                      <h5>Requests</h5>
                      <h3>#</h3>
                  </div>
              </article>
              <article id="appointments-info">
                <div id="calendar">
                  <div id="calendar-header">
                    <h1>{MMM} {YYYY}</h1>
                    <div id="calendar-navigation">
                      <button>&lt;</button>
                      <button>&gt;</button>
                    </div>
                  </div>
                  <div id="calendar-days">
                    <div class="selected-day">
                      <p>Mon</p>
                      <strong>##</strong>
                    </div>
                    <div>
                      <p>Tue</p>
                      <strong>##</strong>
                    </div>
                    <div>
                      <p>Wed</p>
                      <strong>##</strong>
                    </div>
                    <div>
                      <p>Thu</p>
                      <strong>##</strong>
                    </div>
                    <div>
                      <p>Fri</p>
                      <strong>##</strong>
                    </div>
                    <div>
                      <p>Sat</p>
                      <strong>##</strong>
                    </div>
                    <div>
                      <p>Sun</p>
                      <strong>##</strong>
                    </div>
                  </div>
                </div>
                <div id="appointments">
                  <figure id="loadingOverlay" onanimationstart="updateLoadingStatus(event)" onanimationiteration="updateLoadingStatus(event)">
                    <div>
                      <div class="dot union"></div>
                      <div class="dot"></div>
                      <div class="dot"></div>
                      <div class="dot"></div>
                      <div class="dot"></div>
                    </div>
                  </figure>
                  <div id="appointments-content">
                    <h4>Appointments</h4>
                    <template id="day-group-template">
                      <div class="day-group">
                        <h6>{Relative}, {DD} {MMM}</h6>
                        <template id="appointment-template">
                          <div class="appointment">
                            <span>{hh}:{mm}</span>
                            <div>
                              <img src="https://wallpapers.com/images/hd/generic-male-avatar-profile-2fudx37oj7ug3d8l.jpg">
                              <div>
                                <h6>{FName} {LName}</h6>
                                <p>{Appointment Type}</p>
                              </div>
                            </div>
                          </div>
                        </template>
                      </div>
                    </template>
                  </div>
                </div>
              </article>
              <article id="appointments-stats">
                <h1>Appointments Statistics</h1>
                <div id="appts-stats-filter">
                  <div>
                    <h4>{MMMM} {YYYY}</h4>
                    <div>
                      <button>&lt;</button>
                      <button>&gt;</button>
                    </div>
                  </div>
                  <select name="frequency">
                    <option value="hourly">Hourly</option>
                    <option value="daily" selected>Daily</option>
                    <option value="weekly">Weekly</option>
                    <option value="monthly">Monthly</option>
                  </select>
                </div>
                <figure><canvas></canvas></figure>
              </article>
              <article id="latest-patient-info">
                <h1>Latest Requests</h1>
                <table>
                  <thead>
                    <tr>
                      <th>ID</th>
                      <th>Date</th>
                      <th>From</th>
                      <th>Details</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>###</td>
                      <td>{DD MMMM YYYY}</td>
                      <td>{FName} {LName}</td>
                      <td>{Details}</td>
                    </tr>
                    <tr>
                      <td>###</td>
                      <td>{DD MMMM YYYY}</td>
                      <td>{FName} {LName}</td>
                      <td>{Details}</td>
                    </tr>
                    <tr>
                      <td>###</td>
                      <td>{DD MMMM YYYY}</td>
                      <td>{FName} {LName}</td>
                      <td>{Details}</td>
                    </tr>
                  </tbody>
                </table>
              </article>
          </div>
        </div>
      </section>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.2/dist/chart.umd.min.js"></script>
    <script type="text/javascript">
      const appointmentStatsElem = document.getElementById('appointments-stats').getElementsByTagName('canvas')[0];
      let chart = new Chart(appointmentStatsElem, {
        type: 'line',
        data: {
          labels: ["Thu 1", "Fri 2", "Sat 3", "Sun 4", "Mon 5", "Tue 6", "Wed 7"],
          datasets: [{
            data: [10, 10, 10, 10, 10, 10, 10],
            
            borderCapStyle: 'round',
            borderColor: '#C40148',
            
            pointBackgroundColor: 'transparent',
            pointBorderColor: '#FFFFFF',
            pointBorderWidth: 0,
            pointRadius: 5,
            
            pointHoverBackgroundColor: '#FF005D',
            pointHoverBorderColor: '#FFFFFF',
            pointHoverBorderWidth: 3,
            
            lineTension: 0.3,
            fill: false
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: true,
          interaction: {
            mode: 'nearest',
            axis: 'x',
            intersect: false
          },
          scales: {
            x: {
              border: {
                display: false
              },
              grid: {
                display: false
              }
            },
            y: {
              ticks: {
                stepSize: 5
              },
              border: {
                display: false
              },
              grid: {
                display: false
              }
            }
          },
          plugins: {
            legend: {
              display: false
            },
            tooltip: {
              enabled: false,
              external: (context) => {
                const { chart, tooltip } = context;
                let tooltipEl = chart.canvas.parentNode.children[1];

                // Create tooltip element if it doesn't exist
                if (!tooltipEl) {
                    tooltipEl = document.createElement('div');
                    tooltipEl.id = "tooltip-wrapper";
                    tooltipEl.style.cssText = `
                        height: 100%;
                        opacity: 0;
                        color: var(--trinary-colour);
                        font-weight: bold;
                        position: absolute;
                        translate: -50%;
                        transition: all 0.25s ease;
                        white-space: nowrap;
                        pointer-events: none;
                        padding-top: 0.5rem;
                        padding-bottom: 2.5rem;
                    `;
                    tooltipEl.appendChild(document.createTextNode(""));

                    // Create and style divider element
                    const divider = document.createElement('div');
                    divider.style.cssText = `
                        height: 100%;
                        width: 1px;
                        border: 1px dashed color-mix(in srgb, transparent, var(--trinary-colour) 25%);
                        margin: 0 auto;
                        transition: all 0.25s ease;
                        position: relative;
                    `;
                    tooltipEl.appendChild(divider);

                    // Append tooltip element to parent node
                    chart.canvas.style.position = "relative";
                    chart.canvas.style.zIndex = "1";
                    chart.canvas.parentNode.style.position = "relative";
                    chart.canvas.parentNode.appendChild(tooltipEl);
                }

                // Calculate tooltip position
                const { offsetLeft, offsetTop, offsetWidth } = chart.canvas;
                const leftPointPos = offsetLeft + tooltip.caretX;
                tooltipEl.style.left = leftPointPos + 'px';
                tooltipEl.style.top = `calc(${offsetTop}px - 1.5rem)`;
                tooltipEl.style.opacity = tooltip.opacity;

                // Update tooltip content
                tooltipEl.replaceChild(document.createTextNode(`${tooltip.dataPoints[0].formattedValue} Appointments`), tooltipEl.childNodes[0]);

                // Adjust divider position based on tooltip position
                const correction = tooltipEl.offsetWidth / 2;
                let dividerLeft = '0', dividerTranslateX = '-50%';

                if (leftPointPos <= correction) {
                    dividerLeft = `-${correction}px`;
                    dividerTranslateX = `calc(-50% + ${correction}px)`;
                } else if (leftPointPos >= offsetWidth - correction) {
                    dividerLeft = `${correction}px`;
                    dividerTranslateX = `calc(-50% - ${correction}px)`;
                }

                tooltipEl.children[0].style.left = dividerLeft;
                tooltipEl.style.translate = dividerTranslateX;

              }
            }
          }
        }
      });
    </script>

    <!-- <script type="text/javascript" src="../../main.js"></script> -->
    <script type="text/javascript" src="./script.js"></script>
  </body>
</html>